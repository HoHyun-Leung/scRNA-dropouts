library(ggplot2)
library(RColorBrewer)

A.0 <- read.table('/Users/kexuanliang/Documents/singlecell/git/scRNA-dropouts/test-data/alterA/0/para-results.txt', sep = '', header = T)
A.0.2 <- read.table('/Users/kexuanliang/Documents/singlecell/git/scRNA-dropouts/test-data/alterA/0.2/para-results.txt', sep = '', header = T)
A.0.2.ct <- read.table('/Users/kexuanliang/Documents/singlecell/git/scRNA-dropouts/test-data/alterA.ct/para-results.txt', sep ='', header = T)
A.0$group <- rep('A = 0 (1 cell type)',100)
A.0.2$group <- rep('A = 0.2 (1 cell type)',100)
A.0.2.ct$group <- rep('A = 0.2 (3 cell types)',100)
names(A.0.2.ct)[8] <- 'theta'
para <- merge(A.0, A.0.2, all.x = T, all.y = T)
para <- merge(para, A.0.2.ct, all.x = T, all.y = T)
#names(para) <- c('group', 'nu1', 'nu2', 'sigsq1', 'sigsq2', 'gamma', 'alpha', 'beta', 'theta')
write.table(para, '/Users/kexuanliang/Documents/singlecell/git/scRNA-dropouts/test-data/para-all.txt', sep = '')
setwd('/Users/kexuanliang/Documents/singlecell/git/scRNA-dropouts/test-data/')
p <- ggplot(data = para, aes(x=group, y=nu1)) + geom_boxplot(aes(fill=group))
p <- p + labs(title="Nu1 = -0.1", y = "nu1 value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("estimated value for nu1")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=nu2)) + geom_boxplot(aes(fill=group))
p <- p + labs(title="Nu2 = 0.1", y = "nu2 value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("estimated value for nu2")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=gamma)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Gamma = -0.5", y = "Gamma value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Gamma")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=alpha)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Alpha in different settings", y = "Alpha value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Alpha")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=beta)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Beta = 0.1", y = "Beta value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Beta")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=theta)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Theta = 1 ", y = "theta value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Theta")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=sigsq1)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Sigma1-square = 1", y = "sigsq-1 value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Sigma1-square")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

p <- ggplot(data = para, aes(x=group, y=sigsq2)) + geom_boxplot(aes(fill=group))
p <- p + labs(title=" Sigma2-square = 1", y = "sigsq-2 value", x = "group")
p <- p + guides(fill=FALSE)
p <- p + xlab("datasets used for test") + ylab("Estimated value for Sigma2-square")
p + facet_wrap(~ group, scales="free") + theme(plot.title = element_text(hjust = 0.5))

